parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"fUSB":[function(require,module,exports) {
"use strict";function e(e){return e.name}function o(o){return e(o)}function t(e){for(var o=[],t=0;t<e.length;t++){var n=e[t];if(!p(n))throw new Error("Tried to create a query with an unregistered component");if("object"==typeof n){var r="not"===n.operator?"!":n.operator;o.push(r+n.Component._typeId)}else o.push(n._typeId)}return o.sort().join("-")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getName=e,exports.componentPropertyName=o,exports.queryKey=t,exports.componentRegistered=p,exports.now=exports.hasWindow=void 0;const n="undefined"!=typeof window;exports.hasWindow=n;const r=n&&void 0!==window.performance?performance.now.bind(performance):Date.now.bind(Date);function p(e){return"object"==typeof e&&void 0!==e.Component._typeId||e.isComponent&&void 0!==e._typeId}exports.now=r;
},{}],"rwcL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SystemManager=void 0;var e=require("./Utils.js");class s{constructor(e){this._systems=[],this._executeSystems=[],this.world=e,this.lastExecutedSystem=null}registerSystem(e,s){if(!e.isSystem)throw new Error(`System '${e.name}' does not extend 'System' class`);if(void 0!==this.getSystem(e))return console.warn(`System '${e.getName()}' already registered.`),this;var t=new e(this.world,s);return t.init&&t.init(s),t.order=this._systems.length,this._systems.push(t),t.execute&&(this._executeSystems.push(t),this.sortSystems()),this}unregisterSystem(e){let s=this.getSystem(e);return void 0===s?(console.warn(`Can unregister system '${e.getName()}'. It doesn't exist.`),this):(this._systems.splice(this._systems.indexOf(s),1),s.execute&&this._executeSystems.splice(this._executeSystems.indexOf(s),1),this)}sortSystems(){this._executeSystems.sort((e,s)=>e.priority-s.priority||e.order-s.order)}getSystem(e){return this._systems.find(s=>s instanceof e)}getSystems(){return this._systems}removeSystem(e){var s=this._systems.indexOf(e);~s&&this._systems.splice(s,1)}executeSystem(s,t,i){if(s.initialized&&s.canExecute()){let r=(0,e.now)();s.execute(t,i),s.executeTime=(0,e.now)()-r,this.lastExecutedSystem=s,s.clearEvents()}}stop(){this._executeSystems.forEach(e=>e.stop())}execute(e,s,t){this._executeSystems.forEach(i=>(t||i.enabled)&&this.executeSystem(i,e,s))}stats(){for(var e={numSystems:this._systems.length,systems:{}},s=0;s<this._systems.length;s++){var t=this._systems[s],i=e.systems[t.getName()]={queries:{},executeTime:t.executeTime};for(var r in t.ctx)i.queries[r]=t.ctx[r].stats()}return e}}exports.SystemManager=s;
},{"./Utils.js":"fUSB"}],"Lfks":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ObjectPool=void 0;class t{constructor(t,e){this.freeList=[],this.count=0,this.T=t,this.isObjectPool=!0,void 0!==e&&this.expand(e)}acquire(){return this.freeList.length<=0&&this.expand(Math.round(.2*this.count)+1),this.freeList.pop()}release(t){t.reset(),this.freeList.push(t)}expand(t){for(var e=0;e<t;e++){var s=new this.T;s._pool=this,this.freeList.push(s)}this.count+=t}totalSize(){return this.count}totalFree(){return this.freeList.length}totalUsed(){return this.count-this.freeList.length}}exports.ObjectPool=t;
},{}],"cMn2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;class e{constructor(){this._listeners={},this.stats={fired:0,handled:0}}addEventListener(e,s){let t=this._listeners;void 0===t[e]&&(t[e]=[]),-1===t[e].indexOf(s)&&t[e].push(s)}hasEventListener(e,s){return void 0!==this._listeners[e]&&-1!==this._listeners[e].indexOf(s)}removeEventListener(e,s){var t=this._listeners[e];if(void 0!==t){var i=t.indexOf(s);-1!==i&&t.splice(i,1)}}dispatchEvent(e,s,t){this.stats.fired++;var i=this._listeners[e];if(void 0!==i)for(var r=i.slice(0),n=0;n<r.length;n++)r[n].call(this,s,t)}resetCounters(){this.stats.fired=this.stats.handled=0}}exports.default=e;
},{}],"qAZx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=s(require("./EventDispatcher.js")),e=require("./Utils.js");function s(t){return t&&t.__esModule?t:{default:t}}class i{constructor(s,i){if(this.Components=[],this.NotComponents=[],s.forEach(t=>{"object"==typeof t?this.NotComponents.push(t.Component):this.Components.push(t)}),0===this.Components.length)throw new Error("Can't create a query without components");this.entities=[],this.eventDispatcher=new t.default,this.reactive=!1,this.key=(0,e.queryKey)(s);for(var n=0;n<i._entities.length;n++){var o=i._entities[n];this.match(o)&&(o.queries.push(this),this.entities.push(o))}}addEntity(t){t.queries.push(this),this.entities.push(t),this.eventDispatcher.dispatchEvent(i.prototype.ENTITY_ADDED,t)}removeEntity(t){let e=this.entities.indexOf(t);~e&&(this.entities.splice(e,1),e=t.queries.indexOf(this),t.queries.splice(e,1),this.eventDispatcher.dispatchEvent(i.prototype.ENTITY_REMOVED,t))}match(t){return t.hasAllComponents(this.Components)&&!t.hasAnyComponents(this.NotComponents)}toJSON(){return{key:this.key,reactive:this.reactive,components:{included:this.Components.map(t=>t.name),not:this.NotComponents.map(t=>t.name)},numEntities:this.entities.length}}stats(){return{numComponents:this.Components.length,numEntities:this.entities.length}}}exports.default=i,i.prototype.ENTITY_ADDED="Query#ENTITY_ADDED",i.prototype.ENTITY_REMOVED="Query#ENTITY_REMOVED",i.prototype.COMPONENT_CHANGED="Query#COMPONENT_CHANGED";
},{"./EventDispatcher.js":"cMn2","./Utils.js":"fUSB"}],"YRDu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=i(require("./Query.js")),t=require("./Utils.js");function i(e){return e&&e.__esModule?e:{default:e}}class r{constructor(e){this._world=e,this._queries={}}onEntityRemoved(e){for(var t in this._queries){var i=this._queries[t];-1!==e.queries.indexOf(i)&&i.removeEntity(e)}}onEntityComponentAdded(e,t){for(var i in this._queries){var r=this._queries[i];~r.NotComponents.indexOf(t)&&~r.entities.indexOf(e)?r.removeEntity(e):~r.Components.indexOf(t)&&r.match(e)&&!~r.entities.indexOf(e)&&r.addEntity(e)}}onEntityComponentRemoved(e,t){for(var i in this._queries){var r=this._queries[i];~r.NotComponents.indexOf(t)&&!~r.entities.indexOf(e)&&r.match(e)?r.addEntity(e):~r.Components.indexOf(t)&&~r.entities.indexOf(e)&&!r.match(e)&&r.removeEntity(e)}}getQuery(i){var r=(0,t.queryKey)(i),s=this._queries[r];return s||(this._queries[r]=s=new e.default(i,this._world)),s}stats(){var e={};for(var t in this._queries)e[t]=this._queries[t].stats();return e}}exports.default=r;
},{"./Query.js":"qAZx","./Utils.js":"fUSB"}],"yjHX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Component=void 0;class t{constructor(t){if(!1!==t){const e=this.constructor.schema;for(const s in e)if(t&&t.hasOwnProperty(s))this[s]=t[s];else{const t=e[s];if(t.hasOwnProperty("default"))this[s]=t.type.clone(t.default);else{const e=t.type;this[s]=e.clone(e.default)}}0}this._pool=null}copy(t){const e=this.constructor.schema;for(const s in e){const o=e[s];t.hasOwnProperty(s)&&(this[s]=o.type.copy(t[s],this[s]))}return this}clone(){return(new this.constructor).copy(this)}reset(){const t=this.constructor.schema;for(const e in t){const s=t[e];if(s.hasOwnProperty("default"))this[e]=s.type.copy(s.default,this[e]);else{const t=s.type;this[e]=t.copy(t.default,this[e])}}}dispose(){this._pool&&this._pool.release(this)}getName(){return this.constructor.getName()}checkUndefinedAttributes(t){const e=this.constructor.schema;Object.keys(t).forEach(t=>{e.hasOwnProperty(t)||console.warn(`Trying to set attribute '${t}' not defined in the '${this.constructor.name}' schema. Please fix the schema, the attribute value won't be set`)})}}exports.Component=t,t.schema={},t.isComponent=!0,t.getName=function(){return this.displayName||this.name};
},{}],"RA46":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SystemStateComponent=void 0;var e=require("./Component");class t extends e.Component{}exports.SystemStateComponent=t,t.isSystemStateComponent=!0;
},{"./Component":"yjHX"}],"vuhp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EntityManager=void 0;var e=require("./ObjectPool.js"),t=s(require("./QueryManager.js")),n=s(require("./EventDispatcher.js")),o=require("./SystemStateComponent.js");function s(e){return e&&e.__esModule?e:{default:e}}class i extends e.ObjectPool{constructor(e,t,n){super(t,void 0),this.entityManager=e,void 0!==n&&this.expand(n)}expand(e){for(var t=0;t<e;t++){var n=new this.T(this.entityManager);n._pool=this,this.freeList.push(n)}this.count+=e}}class r{constructor(e){this.world=e,this.componentsManager=e.componentsManager,this._entities=[],this._nextEntityId=0,this._entitiesByNames={},this._queryManager=new t.default(this),this.eventDispatcher=new n.default,this._entityPool=new i(this,this.world.options.entityClass,this.world.options.entityPoolSize),this.entitiesWithComponentsToRemove=[],this.entitiesToRemove=[],this.deferredRemovalEnabled=!0}getEntityByName(e){return this._entitiesByNames[e]}createEntity(e){var t=this._entityPool.acquire();return t.alive=!0,t.name=e||"",e&&(this._entitiesByNames[e]?console.warn(`Entity name '${e}' already exist`):this._entitiesByNames[e]=t),this._entities.push(t),this.eventDispatcher.dispatchEvent(a,t),t}entityAddComponent(e,t,n){if(void 0===t._typeId&&!this.world.componentsManager._ComponentsMap[t._typeId])throw new Error(`Attempted to add unregistered component "${t.getName()}"`);if(!~e._ComponentTypes.indexOf(t)){e._ComponentTypes.push(t),t.__proto__===o.SystemStateComponent&&e.numStateComponents++;var s=this.world.componentsManager.getComponentsPool(t),i=s?s.acquire():new t(n);s&&n&&i.copy(n),e._components[t._typeId]=i,this._queryManager.onEntityComponentAdded(e,t),this.world.componentsManager.componentAddedToEntity(t),this.eventDispatcher.dispatchEvent(m,e,t)}}entityRemoveComponent(e,t,n){var s=e._ComponentTypes.indexOf(t);~s&&(this.eventDispatcher.dispatchEvent(h,e,t),n?this._entityRemoveComponentSync(e,t,s):(0===e._ComponentTypesToRemove.length&&this.entitiesWithComponentsToRemove.push(e),e._ComponentTypes.splice(s,1),e._ComponentTypesToRemove.push(t),e._componentsToRemove[t._typeId]=e._components[t._typeId],delete e._components[t._typeId]),this._queryManager.onEntityComponentRemoved(e,t),t.__proto__===o.SystemStateComponent&&(e.numStateComponents--,0!==e.numStateComponents||e.alive||e.remove()))}_entityRemoveComponentSync(e,t,n){e._ComponentTypes.splice(n,1);var o=e._components[t._typeId];delete e._components[t._typeId],o.dispose(),this.world.componentsManager.componentRemovedFromEntity(t)}entityRemoveAllComponents(e,t){let n=e._ComponentTypes;for(let s=n.length-1;s>=0;s--)n[s].__proto__!==o.SystemStateComponent&&this.entityRemoveComponent(e,n[s],t)}removeEntity(e,t){var n=this._entities.indexOf(e);if(!~n)throw new Error("Tried to remove entity not in list");e.alive=!1,0===e.numStateComponents&&(this.eventDispatcher.dispatchEvent(p,e),this._queryManager.onEntityRemoved(e),!0===t?this._releaseEntity(e,n):this.entitiesToRemove.push(e)),this.entityRemoveAllComponents(e,t)}_releaseEntity(e,t){this._entities.splice(t,1),this._entitiesByNames[e.name]&&delete this._entitiesByNames[e.name],e._pool.release(e)}removeAllEntities(){for(var e=this._entities.length-1;e>=0;e--)this.removeEntity(this._entities[e])}processDeferredRemoval(){if(this.deferredRemovalEnabled){for(let e=0;e<this.entitiesToRemove.length;e++){let t=this.entitiesToRemove[e],n=this._entities.indexOf(t);this._releaseEntity(t,n)}this.entitiesToRemove.length=0;for(let t=0;t<this.entitiesWithComponentsToRemove.length;t++){let n=this.entitiesWithComponentsToRemove[t];for(;n._ComponentTypesToRemove.length>0;){let t=n._ComponentTypesToRemove.pop();var e=n._componentsToRemove[t._typeId];delete n._componentsToRemove[t._typeId],e.dispose(),this.world.componentsManager.componentRemovedFromEntity(t)}}this.entitiesWithComponentsToRemove.length=0}}queryComponents(e){return this._queryManager.getQuery(e)}count(){return this._entities.length}stats(){var e={numEntities:this._entities.length,numQueries:Object.keys(this._queryManager._queries).length,queries:this._queryManager.stats(),numComponentPool:Object.keys(this.componentsManager._componentPool).length,componentPool:{},eventDispatcher:this.eventDispatcher.stats};for(var t in this.componentsManager._componentPool){var n=this.componentsManager._componentPool[t];e.componentPool[n.T.getName()]={used:n.totalUsed(),size:n.count}}return e}}exports.EntityManager=r;const a="EntityManager#ENTITY_CREATE",p="EntityManager#ENTITY_REMOVED",m="EntityManager#COMPONENT_ADDED",h="EntityManager#COMPONENT_REMOVE";
},{"./ObjectPool.js":"Lfks","./QueryManager.js":"YRDu","./EventDispatcher.js":"cMn2","./SystemStateComponent.js":"RA46"}],"W0Iw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ComponentManager=void 0;var o=require("./ObjectPool.js");class e{constructor(){this.Components=[],this._ComponentsMap={},this._componentPool={},this.numComponents={},this.nextComponentId=0}hasComponent(o){return-1!==this.Components.indexOf(o)}registerComponent(e,t){if(-1!==this.Components.indexOf(e))return void console.warn(`Component type: '${e.getName()}' already registered.`);const n=e.schema;if(!n)throw new Error(`Component "${e.getName()}" has no schema property.`);for(const o in n){if(!n[o].type)throw new Error(`Invalid schema for component "${e.getName()}". Missing type for "${o}" property.`)}e._typeId=this.nextComponentId++,this.Components.push(e),this._ComponentsMap[e._typeId]=e,this.numComponents[e._typeId]=0,void 0===t?t=new o.ObjectPool(e):!1===t&&(t=void 0),this._componentPool[e._typeId]=t}componentAddedToEntity(o){this.numComponents[o._typeId]++}componentRemovedFromEntity(o){this.numComponents[o._typeId]--}getComponentsPool(o){return this._componentPool[o._typeId]}}exports.ComponentManager=e;
},{"./ObjectPool.js":"Lfks"}],"Ly4q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Version=void 0;const e="0.3.1";exports.Version="0.3.1";
},{}],"rAig":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=o;const e=new WeakMap,t={set(e,t){throw new Error(`Tried to write to "${e.constructor.getName()}#${String(t)}" on immutable component. Use .getMutableComponent() to modify a component.`)}};function o(o,r){if(void 0===r)return;let n=e.get(r);return n||(n=new Proxy(r,t),e.set(r,n)),n}
},{}],"KCxR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Entity=void 0;var e=n(require("./Query.js")),t=n(require("./WrapImmutableComponent.js"));function n(e){return e&&e.__esModule?e:{default:e}}class o{constructor(e){this._entityManager=e||null,this.id=e._nextEntityId++,this._ComponentTypes=[],this._components={},this._componentsToRemove={},this.queries=[],this._ComponentTypesToRemove=[],this.alive=!1,this.numStateComponents=0}getComponent(e,t){var n=this._components[e._typeId];return n||!0!==t||(n=this._componentsToRemove[e._typeId]),n}getRemovedComponent(e){const t=this._componentsToRemove[e._typeId];return t}getComponents(){return this._components}getComponentsToRemove(){return this._componentsToRemove}getComponentTypes(){return this._ComponentTypes}getMutableComponent(t){var n=this._components[t._typeId];if(n){for(var o=0;o<this.queries.length;o++){var s=this.queries[o];s.reactive&&-1!==s.Components.indexOf(t)&&s.eventDispatcher.dispatchEvent(e.default.prototype.COMPONENT_CHANGED,this,n)}return n}}addComponent(e,t){return this._entityManager.entityAddComponent(this,e,t),this}removeComponent(e,t){return this._entityManager.entityRemoveComponent(this,e,t),this}hasComponent(e,t){return!!~this._ComponentTypes.indexOf(e)||!0===t&&this.hasRemovedComponent(e)}hasRemovedComponent(e){return!!~this._ComponentTypesToRemove.indexOf(e)}hasAllComponents(e){for(var t=0;t<e.length;t++)if(!this.hasComponent(e[t]))return!1;return!0}hasAnyComponents(e){for(var t=0;t<e.length;t++)if(this.hasComponent(e[t]))return!0;return!1}removeAllComponents(e){return this._entityManager.entityRemoveAllComponents(this,e)}copy(e){for(var t in e._components){var n=e._components[t];this.addComponent(n.constructor),this.getComponent(n.constructor).copy(n)}return this}clone(){return new o(this._entityManager).copy(this)}reset(){for(var e in this.id=this._entityManager._nextEntityId++,this._ComponentTypes.length=0,this.queries.length=0,this._components)delete this._components[e]}remove(e){return this._entityManager.removeEntity(this,e)}}exports.Entity=o;
},{"./Query.js":"qAZx","./WrapImmutableComponent.js":"rAig"}],"KJ4w":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.World=void 0;var e=require("./SystemManager.js"),t=require("./EntityManager.js"),s=require("./ComponentManager.js"),n=require("./Version.js"),r=require("./Utils.js"),i=require("./Entity.js");const a={entityPoolSize:0,entityClass:i.Entity};class o{constructor(i={}){if(this.options=Object.assign({},a,i),this.componentsManager=new s.ComponentManager(this),this.entityManager=new t.EntityManager(this),this.systemManager=new e.SystemManager(this),this.enabled=!0,this.eventQueues={},r.hasWindow&&"undefined"!=typeof CustomEvent){var o=new CustomEvent("ecsy-world-created",{detail:{world:this,version:n.Version}});window.dispatchEvent(o)}this.lastTime=(0,r.now)()/1e3}registerComponent(e,t){return this.componentsManager.registerComponent(e,t),this}registerSystem(e,t){return this.systemManager.registerSystem(e,t),this}hasRegisteredComponent(e){return this.componentsManager.hasComponent(e)}unregisterSystem(e){return this.systemManager.unregisterSystem(e),this}getSystem(e){return this.systemManager.getSystem(e)}getSystems(){return this.systemManager.getSystems()}execute(e,t){e||(e=(t=(0,r.now)()/1e3)-this.lastTime,this.lastTime=t),this.enabled&&(this.systemManager.execute(e,t),this.entityManager.processDeferredRemoval())}stop(){this.enabled=!1}play(){this.enabled=!0}createEntity(e){return this.entityManager.createEntity(e)}stats(){return{entities:this.entityManager.stats(),system:this.systemManager.stats()}}}exports.World=o;
},{"./SystemManager.js":"rwcL","./EntityManager.js":"vuhp","./ComponentManager.js":"W0Iw","./Version.js":"Ly4q","./Utils.js":"fUSB","./Entity.js":"KCxR"}],"zOc3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Not=s,exports.System=void 0;var e=r(require("./Query.js")),t=require("./Utils.js");function r(e){return e&&e.__esModule?e:{default:e}}class i{canExecute(){if(0===this._mandatoryQueries.length)return!0;for(let e=0;e<this._mandatoryQueries.length;e++){if(0===this._mandatoryQueries[e].entities.length)return!1}return!0}getName(){return this.constructor.getName()}constructor(r,i){if(this.world=r,this.enabled=!0,this._queries={},this.queries={},this.priority=0,this.executeTime=0,i&&i.priority&&(this.priority=i.priority),this._mandatoryQueries=[],this.initialized=!0,this.constructor.queries)for(var s in this.constructor.queries){var n=this.constructor.queries[s],o=n.components;if(!o||0===o.length)throw new Error("'components' attribute can't be empty in a query");let r=o.filter(e=>!(0,t.componentRegistered)(e));if(r.length>0)throw new Error(`Tried to create a query '${this.constructor.name}.${s}' with unregistered components: [${r.map(e=>e.getName()).join(", ")}]`);var a=this.world.entityManager.queryComponents(o);this._queries[s]=a,!0===n.mandatory&&this._mandatoryQueries.push(a),this.queries[s]={results:a.entities};var d=["added","removed","changed"];const i={added:e.default.prototype.ENTITY_ADDED,removed:e.default.prototype.ENTITY_REMOVED,changed:e.default.prototype.COMPONENT_CHANGED};n.listen&&d.forEach(t=>{if(this.execute||console.warn(`System '${this.getName()}' has defined listen events (${d.join(", ")}) for query '${s}' but it does not implement the 'execute' method.`),n.listen[t]){let r=n.listen[t];if("changed"===t){if(a.reactive=!0,!0===r){let r=this.queries[s][t]=[];a.eventDispatcher.addEventListener(e.default.prototype.COMPONENT_CHANGED,e=>{-1===r.indexOf(e)&&r.push(e)})}else if(Array.isArray(r)){let i=this.queries[s][t]=[];a.eventDispatcher.addEventListener(e.default.prototype.COMPONENT_CHANGED,(e,t)=>{-1!==r.indexOf(t.constructor)&&-1===i.indexOf(e)&&i.push(e)})}}else{let e=this.queries[s][t]=[];a.eventDispatcher.addEventListener(i[t],t=>{-1===e.indexOf(t)&&e.push(t)})}}})}}stop(){this.executeTime=0,this.enabled=!1}play(){this.enabled=!0}clearEvents(){for(let t in this.queries){var e=this.queries[t];if(e.added&&(e.added.length=0),e.removed&&(e.removed.length=0),e.changed)if(Array.isArray(e.changed))e.changed.length=0;else for(let t in e.changed)e.changed[t].length=0}}toJSON(){var e={name:this.getName(),enabled:this.enabled,executeTime:this.executeTime,priority:this.priority,queries:{}};if(this.constructor.queries){var t=this.constructor.queries;for(let r in t){let i=this.queries[r],s=t[r],n=e.queries[r]={key:this._queries[r].key};if(n.mandatory=!0===s.mandatory,n.reactive=s.listen&&(!0===s.listen.added||!0===s.listen.removed||!0===s.listen.changed||Array.isArray(s.listen.changed)),n.reactive){n.listen={},["added","removed","changed"].forEach(e=>{i[e]&&(n.listen[e]={entities:i[e].length})})}}}return e}}function s(e){return{operator:"not",Component:e}}exports.System=i,i.isSystem=!0,i.getName=function(){return this.displayName||this.name};
},{"./Query.js":"qAZx","./Utils.js":"fUSB"}],"ZGEo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TagComponent=void 0;var e=require("./Component");class o extends e.Component{constructor(){super(!1)}}exports.TagComponent=o,o.isTagComponent=!0;
},{"./Component":"yjHX"}],"i1BC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createType=s,exports.Types=exports.cloneClonable=exports.copyCopyable=exports.cloneJSON=exports.copyJSON=exports.cloneArray=exports.copyArray=exports.cloneValue=exports.copyValue=void 0;const e=e=>e;exports.copyValue=e;const o=e=>e;exports.cloneValue=o;const r=(e,o)=>{if(!e)return e;if(!o)return e.slice();o.length=0;for(let r=0;r<e.length;r++)o.push(e[r]);return o};exports.copyArray=r;const t=e=>e&&e.slice();exports.cloneArray=t;const n=e=>JSON.parse(JSON.stringify(e));exports.copyJSON=n;const p=e=>JSON.parse(JSON.stringify(e));exports.cloneJSON=p;const c=(e,o)=>e?o?o.copy(e):e.clone():e;exports.copyCopyable=c;const l=e=>e&&e.clone();function s(e){var o=["name","default","copy","clone"].filter(o=>!e.hasOwnProperty(o));if(o.length>0)throw new Error(`createType expects a type definition with the following properties: ${o.join(", ")}`);return e.isType=!0,e}exports.cloneClonable=l;const a={Number:s({name:"Number",default:0,copy:e,clone:o}),Boolean:s({name:"Boolean",default:!1,copy:e,clone:o}),String:s({name:"String",default:"",copy:e,clone:o}),Array:s({name:"Array",default:[],copy:r,clone:t}),Ref:s({name:"Ref",default:void 0,copy:e,clone:o}),JSON:s({name:"JSON",default:null,copy:n,clone:p})};exports.Types=a;
},{}],"fVhU":[function(require,module,exports) {
"use strict";function e(e){for(var t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n=r.length,o=0;o<e;o++)t+=r.charAt(Math.floor(Math.random()*n));return t}function t(e,t){var r=document.createElement("script");r.src=e,r.onload=t,(document.head||document.documentElement).appendChild(r)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.generateId=e,exports.injectScript=t;
},{}],"uqPp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.enableRemoteDevtools=enableRemoteDevtools;var _utils=require("./utils.js"),_Utils=require("../Utils.js");function hookConsoleAndErrors(e){["error","warning","log"].forEach(o=>{if("function"==typeof console[o]){var t=console[o].bind(console);console[o]=((...n)=>(e.send({method:"console",type:o,args:JSON.stringify(n)}),t.apply(null,n)))}}),window.addEventListener("error",o=>{e.send({method:"error",error:JSON.stringify({message:o.error.message,stack:o.error.stack})})})}function includeRemoteIdHTML(e){let o=document.createElement("div");return o.style.cssText="\n    align-items: center;\n    background-color: #333;\n    color: #aaa;\n    display:flex;\n    font-family: Arial;\n    font-size: 1.1em;\n    height: 40px;\n    justify-content: center;\n    left: 0;\n    opacity: 0.9;\n    position: absolute;\n    right: 0;\n    text-align: center;\n    top: 0;\n  ",o.innerHTML=`Open ECSY devtools to connect to this page using the code:&nbsp;<b style="color: #fff">${e}</b>&nbsp;<button onClick="generateNewCode()">Generate new code</button>`,document.body.appendChild(o),o}function enableRemoteDevtools(remoteId){if(!_Utils.hasWindow)return void console.warn("Remote devtools not available outside the browser");window.generateNewCode=(()=>{window.localStorage.clear(),remoteId=(0,_utils.generateId)(6),window.localStorage.setItem("ecsyRemoteId",remoteId),window.location.reload(!1)}),remoteId=remoteId||window.localStorage.getItem("ecsyRemoteId"),remoteId||(remoteId=(0,_utils.generateId)(6),window.localStorage.setItem("ecsyRemoteId",remoteId));let infoDiv=includeRemoteIdHTML(remoteId);window.__ECSY_REMOTE_DEVTOOLS_INJECTED=!0,window.__ECSY_REMOTE_DEVTOOLS={};let Version="",worldsBeforeLoading=[],onWorldCreated=e=>{var o=e.detail.world;Version=e.detail.version,worldsBeforeLoading.push(o)};window.addEventListener("ecsy-world-created",onWorldCreated);let onLoaded=()=>{var peer=new Peer(remoteId,{host:"peerjs.ecsy.io",secure:!0,port:443,config:{iceServers:[{url:"stun:stun.l.google.com:19302"},{url:"stun:stun1.l.google.com:19302"},{url:"stun:stun2.l.google.com:19302"},{url:"stun:stun3.l.google.com:19302"},{url:"stun:stun4.l.google.com:19302"}]},debug:3});peer.on("open",()=>{peer.on("connection",connection=>{window.__ECSY_REMOTE_DEVTOOLS.connection=connection,connection.on("open",function(){infoDiv.innerHTML="Connected",connection.on("data",function(data){if("init"===data.type){var script=document.createElement("script");script.setAttribute("type","text/javascript"),script.onload=(()=>{script.parentNode.removeChild(script),window.removeEventListener("ecsy-world-created",onWorldCreated),worldsBeforeLoading.forEach(e=>{var o=new CustomEvent("ecsy-world-created",{detail:{world:e,version:Version}});window.dispatchEvent(o)})}),script.innerHTML=data.script,(document.head||document.documentElement).appendChild(script),script.onload(),hookConsoleAndErrors(connection)}else if("executeScript"===data.type){let value=eval(data.script);data.returnEval&&connection.send({method:"evalReturn",value:value})}})})})})};(0,_utils.injectScript)("https://cdn.jsdelivr.net/npm/peerjs@0.3.20/dist/peer.min.js",onLoaded)}if(_Utils.hasWindow){const e=new URLSearchParams(window.location.search);e.has("enable-remote-devtools")&&enableRemoteDevtools()}
},{"./utils.js":"fVhU","../Utils.js":"fUSB"}],"gQmP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"World",{enumerable:!0,get:function(){return e.World}}),Object.defineProperty(exports,"System",{enumerable:!0,get:function(){return t.System}}),Object.defineProperty(exports,"Not",{enumerable:!0,get:function(){return t.Not}}),Object.defineProperty(exports,"Component",{enumerable:!0,get:function(){return r.Component}}),Object.defineProperty(exports,"SystemStateComponent",{enumerable:!0,get:function(){return n.SystemStateComponent}}),Object.defineProperty(exports,"TagComponent",{enumerable:!0,get:function(){return o.TagComponent}}),Object.defineProperty(exports,"ObjectPool",{enumerable:!0,get:function(){return u.ObjectPool}}),Object.defineProperty(exports,"Types",{enumerable:!0,get:function(){return p.Types}}),Object.defineProperty(exports,"createType",{enumerable:!0,get:function(){return p.createType}}),Object.defineProperty(exports,"copyValue",{enumerable:!0,get:function(){return p.copyValue}}),Object.defineProperty(exports,"cloneValue",{enumerable:!0,get:function(){return p.cloneValue}}),Object.defineProperty(exports,"copyArray",{enumerable:!0,get:function(){return p.copyArray}}),Object.defineProperty(exports,"cloneArray",{enumerable:!0,get:function(){return p.cloneArray}}),Object.defineProperty(exports,"copyJSON",{enumerable:!0,get:function(){return p.copyJSON}}),Object.defineProperty(exports,"cloneJSON",{enumerable:!0,get:function(){return p.cloneJSON}}),Object.defineProperty(exports,"copyCopyable",{enumerable:!0,get:function(){return p.copyCopyable}}),Object.defineProperty(exports,"cloneClonable",{enumerable:!0,get:function(){return p.cloneClonable}}),Object.defineProperty(exports,"Version",{enumerable:!0,get:function(){return c.Version}}),Object.defineProperty(exports,"enableRemoteDevtools",{enumerable:!0,get:function(){return i.enableRemoteDevtools}}),Object.defineProperty(exports,"_Entity",{enumerable:!0,get:function(){return l.Entity}});var e=require("./World.js"),t=require("./System.js"),r=require("./Component.js"),n=require("./SystemStateComponent.js"),o=require("./TagComponent.js"),u=require("./ObjectPool.js"),p=require("./Types.js"),c=require("./Version.js"),i=require("./RemoteDevTools/index.js"),l=require("./Entity.js");
},{"./World.js":"KJ4w","./System.js":"zOc3","./Component.js":"yjHX","./SystemStateComponent.js":"RA46","./TagComponent.js":"ZGEo","./ObjectPool.js":"Lfks","./Types.js":"i1BC","./Version.js":"Ly4q","./RemoteDevTools/index.js":"uqPp","./Entity.js":"KCxR"}],"k2vA":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(o,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)o.hasOwnProperty(n)&&(t[n]=o[n])})(o,n)};return function(o,n){function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.BallComponent=void 0;var o=require("ecsy"),n=function(o){function n(){return null!==o&&o.apply(this,arguments)||this}return t(n,o),n}(o.TagComponent);exports.BallComponent=n;
},{"ecsy":"gQmP"}],"YuB3":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.CanvasContextComponent=void 0;var e=require("ecsy"),n=function(n){function o(){return null!==n&&n.apply(this,arguments)||this}return t(o,n),o.schema={ctx:{type:e.Types.Ref},width:{type:e.Types.Number},height:{type:e.Types.Number}},o}(e.Component);exports.CanvasContextComponent=n;
},{"ecsy":"gQmP"}],"O2Yr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Vector2Type=exports.Vector2=void 0;var e=require("ecsy"),t=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t}return e.prototype.set=function(e,t){return this.x=e,this.y=t,this},e.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this},e.prototype.clone=function(){return(new e).set(this.x,this.y)},e}();exports.Vector2=t,exports.Vector2Type=e.createType({name:"Vector2",default:new t,copy:e.copyCopyable,clone:e.cloneClonable});
},{"ecsy":"gQmP"}],"qnLs":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollidableComponent=void 0;var e=require("ecsy"),o=require("../types/Vector2Type"),r=function(r){function n(){return null!==r&&r.apply(this,arguments)||this}return t(n,r),n.schema={box:{type:o.Vector2Type},wallCollision:{type:o.Vector2Type},collidingEntities:{type:e.Types.Array}},n}(e.Component);exports.CollidableComponent=r;
},{"ecsy":"gQmP","../types/Vector2Type":"O2Yr"}],"dUrT":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.GameStateComponent=void 0;var e=require("ecsy"),r=function(r){function o(){return null!==r&&r.apply(this,arguments)||this}return t(o,r),o.schema={player1Points:{type:e.Types.Number},player2Points:{type:e.Types.Number},pressedKeyCodes:{type:e.Types.Array}},o}(e.Component);exports.GameStateComponent=r;
},{"ecsy":"gQmP"}],"HQSp":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.MovementComponent=void 0;var t=require("ecsy"),o=require("../types/Vector2Type"),n=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return e(r,n),r.schema={direction:{type:o.Vector2Type},velocity:{type:t.Types.Number},isEnabled:{type:t.Types.Boolean,default:!0}},r}(t.Component);exports.MovementComponent=n;
},{"ecsy":"gQmP","../types/Vector2Type":"O2Yr"}],"oCDq":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.PaddleComponent=void 0;var e=require("ecsy"),n=function(n){function o(){return null!==n&&n.apply(this,arguments)||this}return t(o,n),o.schema={playerIndex:{type:e.Types.Number}},o}(e.Component);exports.PaddleComponent=n;
},{"ecsy":"gQmP"}],"z2mr":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.PositionComponent=void 0;var e=require("ecsy"),o=require("../types/Vector2Type"),n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.schema={value:{type:o.Vector2Type}},n}(e.Component);exports.PositionComponent=n;
},{"ecsy":"gQmP","../types/Vector2Type":"O2Yr"}],"bLbp":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.RadiusComponent=void 0;var e=require("ecsy"),o=function(o){function n(){return null!==o&&o.apply(this,arguments)||this}return t(n,o),n.schema={value:{type:e.Types.Number}},n}(e.Component);exports.RadiusComponent=o;
},{"ecsy":"gQmP"}],"FliU":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderComponent=void 0;var e=require("ecsy"),n=function(n){function o(){return null!==n&&n.apply(this,arguments)||this}return t(o,n),o.schema={primitive:{type:e.Types.String,default:"box"},isEnabled:{type:e.Types.Boolean,default:!0}},o}(e.Component);exports.RenderComponent=n;
},{"ecsy":"gQmP"}],"i4dX":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.SizeComponent=void 0;var e=require("ecsy"),o=require("../types/Vector2Type"),r=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),r.schema={value:{type:o.Vector2Type}},r}(e.Component);exports.SizeComponent=r;
},{"ecsy":"gQmP","../types/Vector2Type":"O2Yr"}],"iVTS":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),t=this&&this.__exportStar||function(t,r){for(var o in t)"default"===o||r.hasOwnProperty(o)||e(r,t,o)};Object.defineProperty(exports,"__esModule",{value:!0}),t(require("./BallComponent"),exports),t(require("./CanvasContextComponent"),exports),t(require("./CollidableComponent"),exports),t(require("./GameStateComponent"),exports),t(require("./MovementComponent"),exports),t(require("./PaddleComponent"),exports),t(require("./PositionComponent"),exports),t(require("./RadiusComponent"),exports),t(require("./RenderComponent"),exports),t(require("./SizeComponent"),exports);
},{"./BallComponent":"k2vA","./CanvasContextComponent":"YuB3","./CollidableComponent":"qnLs","./GameStateComponent":"dUrT","./MovementComponent":"HQSp","./PaddleComponent":"oCDq","./PositionComponent":"z2mr","./RadiusComponent":"bLbp","./RenderComponent":"FliU","./SizeComponent":"i4dX"}],"b2z3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createBall=void 0;var e=require("../components"),o=require("../types/Vector2Type");function n(n,t,r,p,d){return n.createEntity().addComponent(e.BallComponent).addComponent(e.RenderComponent,{primitive:"circle"}).addComponent(e.MovementComponent,{direction:r,velocity:d}).addComponent(e.PositionComponent,{value:t}).addComponent(e.RadiusComponent,{value:p}).addComponent(e.CollidableComponent,{box:new o.Vector2(10,10)})}exports.createBall=n;
},{"../components":"iVTS","../types/Vector2Type":"O2Yr"}],"IKkU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createPaddle=void 0;var e=require("../components");function o(o,n,t,d,p,r){return o.createEntity().addComponent(e.PaddleComponent,{playerIndex:n}).addComponent(e.RenderComponent,{primitive:"rect"}).addComponent(e.MovementComponent,{direction:d,velocity:p}).addComponent(e.PositionComponent,{value:t}).addComponent(e.SizeComponent,{value:r}).addComponent(e.CollidableComponent,{box:r})}exports.createPaddle=o;
},{"../components":"iVTS"}],"jw5q":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),t=this&&this.__exportStar||function(t,r){for(var i in t)"default"===i||r.hasOwnProperty(i)||e(r,t,i)};Object.defineProperty(exports,"__esModule",{value:!0}),t(require("./Ball"),exports),t(require("./Paddle"),exports);
},{"./Ball":"b2z3","./Paddle":"IKkU"}],"PipX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BoxCollision=void 0;var i=function(){function i(){}return i.isColliding=function(i,o){return i.position.x<o.position.x+o.dimensions.x&&i.position.x+i.dimensions.x>o.position.x&&i.position.y<o.position.y+o.dimensions.y&&i.position.y+i.dimensions.y>o.position.y},i}();exports.BoxCollision=i;
},{}],"KonG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Random=void 0;var e=require("../types/Vector2Type"),r=function(){function r(){}return r.getRandomArbitrary=function(e,r){return Math.random()*(r-e)+e},r.getMinusOrPlusOne=function(){return r.getRandomArbitrary(0,1)<.5?-1:1},r.getRandomDirection=function(){return new e.Vector2(r.getMinusOrPlusOne(),r.getMinusOrPlusOne())},r}();exports.Random=r;
},{"../types/Vector2Type":"O2Yr"}],"u6qm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VectorMath=void 0;var e=require("../types/Vector2Type"),t=function(){function t(){}return t.add=function(t,r){return new e.Vector2(t.x+r.x,t.y+r.y)},t.multiply=function(t,r){return r instanceof e.Vector2?new e.Vector2(t.x*r.x,t.y*r.y):new e.Vector2(t.x*r,t.y*r)},t}();exports.VectorMath=t;
},{"../types/Vector2Type":"O2Yr"}],"s2T4":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),t=this&&this.__exportStar||function(t,r){for(var i in t)"default"===i||r.hasOwnProperty(i)||e(r,t,i)};Object.defineProperty(exports,"__esModule",{value:!0}),t(require("./BoxCollision"),exports),t(require("./Random"),exports),t(require("./VectorMath"),exports);
},{"./BoxCollision":"PipX","./Random":"KonG","./VectorMath":"u6qm"}],"pYDx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PongScene=void 0;var e=require("../prefabs"),t=require("../types/Vector2Type"),r=require("../utils"),o=function(){function o(){}return o.prototype.load=function(o,i){this.ball=e.createBall(o,new t.Vector2(i.width/2,i.height/2),r.Random.getRandomDirection(),10,2);var n=new t.Vector2(20,120);this.paddle1=e.createPaddle(o,0,new t.Vector2(10,i.height/2-n.y/2),new t.Vector2,5,n,10),this.paddle2=e.createPaddle(o,1,new t.Vector2(i.width-n.x-10,i.height/2-n.y/2),new t.Vector2,5,n,10)},o.prototype.unload=function(){this.ball.remove(),this.paddle1.remove(),this.paddle2.remove()},o}();exports.PongScene=o;
},{"../prefabs":"jw5q","../types/Vector2Type":"O2Yr","../utils":"s2T4"}],"LIbJ":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),t=this&&this.__exportStar||function(t,r){for(var n in t)"default"===n||r.hasOwnProperty(n)||e(r,t,n)};Object.defineProperty(exports,"__esModule",{value:!0}),t(require("./PongScene"),exports);
},{"./PongScene":"pYDx"}],"NKWK":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.BallSystem=void 0;var t=require("ecsy"),o=require("../components"),n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.execute=function(){this.queries.balls.results.forEach(function(e){var t=e.getComponent(o.CollidableComponent),n=e.getComponent(o.RadiusComponent),i=e.getMutableComponent(o.PositionComponent),r=e.getMutableComponent(o.MovementComponent);0!==t.wallCollision.y&&(r.direction.y=-r.direction.y,r.velocity+=.1,i.value.y=i.value.y+n.value/2*r.direction.y),0!==t.wallCollision.x&&(r.direction.x=-r.direction.x,i.value.x=i.value.x+n.value*r.direction.x),t.collidingEntities.length&&(r.direction.x=-r.direction.x,i.value.x,n.value,r.direction.x)})},n.queries={balls:{components:[o.BallComponent]}},n}(t.System);exports.BallSystem=n;
},{"ecsy":"gQmP","../components":"iVTS"}],"qPJ2":[function(require,module,exports) {
"use strict";var o=this&&this.__extends||function(){var o=function(n,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,n){o.__proto__=n}||function(o,n){for(var t in n)n.hasOwnProperty(t)&&(o[t]=n[t])})(n,t)};return function(n,t){function e(){this.constructor=n}o(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollisionSystem=void 0;var n=require("ecsy"),t=require("../components"),e=require("../utils"),i=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return o(i,n),i.prototype.execute=function(){var o=this.queries.canvas.results[0],n=this.queries.collidables.results,i=o.getComponent(t.CanvasContextComponent);n.forEach(function(o){var l=o.getMutableComponent(t.CollidableComponent),s=o.getMutableComponent(t.PositionComponent);l.collidingEntities=[],s.value.y>i.height-l.box.y?l.wallCollision.y=1:s.value.y<0?l.wallCollision.y=-1:l.wallCollision.y=0,s.value.x>i.width-l.box.x?l.wallCollision.x=1:s.value.x<0+l.box.x?l.wallCollision.x=-1:l.wallCollision.x=0,n.filter(function(n){return n.id!=o.id}).forEach(function(o){var n=o.getComponent(t.CollidableComponent),i=o.getComponent(t.PositionComponent);e.BoxCollision.isColliding({dimensions:l.box,position:s.value},{dimensions:n.box,position:i.value})&&l.collidingEntities.push(o)})})},i.queries={canvas:{components:[t.CanvasContextComponent]},collidables:{components:[t.CollidableComponent]}},i}(n.System);exports.CollisionSystem=i;
},{"ecsy":"gQmP","../components":"iVTS","../utils":"s2T4"}],"t3is":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.MovementSystem=void 0;var e=require("ecsy"),o=require("../components"),n=require("../utils"),r=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),r.prototype.execute=function(){this.queries.movable.results.forEach(function(t){var e=t.getMutableComponent(o.MovementComponent),r=t.getMutableComponent(o.PositionComponent);if(e.isEnabled){var i=n.VectorMath.multiply(e.direction,e.velocity);r.value=n.VectorMath.add(r.value,i)}})},r.queries={movable:{components:[o.MovementComponent,o.PositionComponent]}},r}(e.System);exports.MovementSystem=r;
},{"ecsy":"gQmP","../components":"iVTS","../utils":"s2T4"}],"tVsJ":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.PaddleSystem=void 0;var t=require("ecsy"),o=require("../components"),n=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.playersControlSchemes={0:{up:87,down:83},1:{up:38,down:40}},e}return e(n,t),n.prototype.execute=function(){var e=this,t=this.queries.paddles.results,n=this.queries.gameState.results[0].getComponent(o.GameStateComponent);t.forEach(function(t){var r=t.getComponent(o.PaddleComponent),s=t.getMutableComponent(o.MovementComponent),i=t.getComponent(o.CollidableComponent),p=e.playersControlSchemes[r.playerIndex];s.direction.y=0,n.pressedKeyCodes.includes(p.up)&&-1!=i.wallCollision.y&&(s.direction.y-=1),n.pressedKeyCodes.includes(p.down)&&1!=i.wallCollision.y&&(s.direction.y+=1)})},n.queries={paddles:{components:[o.PaddleComponent]},gameState:{components:[o.GameStateComponent]}},n}(t.System);exports.PaddleSystem=n;
},{"ecsy":"gQmP","../components":"iVTS"}],"eTwh":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.RendererSystem=void 0;var t=require("ecsy"),n=require("../components"),o=function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return e(o,t),o.prototype.execute=function(){var e=this,t=this.queries.canvas.results[0].getComponent(n.CanvasContextComponent),o=t.ctx,r=t.width,i=t.height;o.fillStyle="black",o.fillRect(0,0,r,i),this.queries.renderables.results.forEach(function(t){var r=t.getComponent(n.RenderComponent),i=r.primitive;if(r.isEnabled){var s={rect:e.renderRect,circle:e.renderCircle};s[i]?s[i](o,t):console.log(i+" primitive does not implement a render function")}})},o.prototype.renderRect=function(e,t){var o=t.getComponent(n.PositionComponent),r=t.getComponent(n.SizeComponent);e.beginPath(),e.rect(o.value.x,o.value.y,r.value.x,r.value.y),e.fillStyle="white",e.fill()},o.prototype.renderCircle=function(e,t){var o=t.getComponent(n.PositionComponent),r=t.getComponent(n.RadiusComponent);e.beginPath(),e.arc(o.value.x,o.value.y,r.value,0,2*Math.PI,!1),e.fillStyle="white",e.fill()},o.queries={canvas:{components:[n.CanvasContextComponent]},renderables:{components:[n.RenderComponent]}},o}(t.System);exports.RendererSystem=o;
},{"ecsy":"gQmP","../components":"iVTS"}],"KXoM":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,r,t,i){void 0===i&&(i=t),Object.defineProperty(e,i,{enumerable:!0,get:function(){return r[t]}})}:function(e,r,t,i){void 0===i&&(i=t),e[i]=r[t]}),r=this&&this.__exportStar||function(r,t){for(var i in r)"default"===i||t.hasOwnProperty(i)||e(t,r,i)};Object.defineProperty(exports,"__esModule",{value:!0}),r(require("./BallSystem"),exports),r(require("./CollisionSystem"),exports),r(require("./MovementSystem"),exports),r(require("./PaddleSystem"),exports),r(require("./RendererSystem"),exports);
},{"./BallSystem":"NKWK","./CollisionSystem":"qPJ2","./MovementSystem":"t3is","./PaddleSystem":"tVsJ","./RendererSystem":"eTwh"}],"QCba":[function(require,module,exports) {
"use strict";var e=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),r=0;for(t=0;t<o;t++)for(var s=arguments[t],i=0,m=s.length;i<m;i++,r++)n[r]=s[i];return n};Object.defineProperty(exports,"__esModule",{value:!0}),exports.world=void 0;var t=require("ecsy"),o=require("./components"),n=require("./scenes"),r=require("./systems");exports.world=new t.World,exports.world.registerComponent(o.BallComponent).registerComponent(o.CanvasContextComponent).registerComponent(o.CollidableComponent).registerComponent(o.GameStateComponent).registerComponent(o.MovementComponent).registerComponent(o.PositionComponent).registerComponent(o.PaddleComponent).registerComponent(o.RadiusComponent).registerComponent(o.RenderComponent).registerComponent(o.SizeComponent).registerSystem(r.CollisionSystem).registerSystem(r.RendererSystem).registerSystem(r.BallSystem).registerSystem(r.PaddleSystem).registerSystem(r.MovementSystem);var s=exports.world.createEntity().addComponent(o.GameStateComponent),i=s.getMutableComponent(o.GameStateComponent),m=document.getElementById("game");exports.world.createEntity().addComponent(o.CanvasContextComponent,{ctx:m.getContext("2d"),width:m.width,height:m.height});var d=new n.PongScene;function p(){exports.world.execute(),requestAnimationFrame(p)}d.load(exports.world,m),window.addEventListener("keydown",function(t){i.pressedKeyCodes=e(i.pressedKeyCodes,[t.keyCode])},!1),window.addEventListener("keyup",function(e){i.pressedKeyCodes=i.pressedKeyCodes.filter(function(t){return t!==e.keyCode})},!1),p();
},{"ecsy":"gQmP","./components":"iVTS","./scenes":"LIbJ","./systems":"KXoM"}]},{},["QCba"], null)
//# sourceMappingURL=/src.a2b40777.js.map